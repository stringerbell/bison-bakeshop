(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{22:function(e,t,n){},23:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(1),c=n.n(r),i=n(9),s=n.n(i),o=(n(22),n.p+"static/media/logo.62cb149e.svg"),u=(n(23),n(3)),l=n.n(u),d=n(4),p=n(5),j=n(10),b=n.n(j),m=n(2),f=n(15),y=n(16),O=n.p+"static/media/rolls.35d1b099.jpg";function h(e){return e.condition?e.children:e.fallback}function x(e){e.date;return Object(a.jsx)(a.Fragment,{children:"We're out of stock."})}var v=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.quantity,a=t.date,r=t.id,e.abrupt("return",fetch("/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:n,id:r,date:a})}).then((function(e){return e.json()})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(e){var t,n=e.amount,a=e.discountAmount,r=e.currency,c=e.quantity,i=new Intl.NumberFormat("en-US",{style:"currency",currency:r,currencyDisplay:"symbol"}),s=i.formatToParts(n),o=!0,u=Object(f.a)(s);try{for(u.s();!(t=u.n()).done;){"decimal"===t.value.type&&(o=!1)}}catch(d){u.e(d)}finally{u.f()}a=o?a:a/100;var l=(n=o?n:n/100)*c;return c>3&&(l=c*a),i.format(l.toFixed(2))};function q(e,t){switch(t.type){case"useEffectUpdate":return Object(m.a)(Object(m.a)(Object(m.a)({},e),t.payload),{},{price:g({amount:t.payload.unitAmount,discountAmount:t.payload.discountAmount,currency:t.payload.currency,quantity:e.quantity})});case"increment":return Object(m.a)(Object(m.a)({},e),{},{quantity:e.quantity+1,price:g({amount:e.unitAmount,discountAmount:e.discountAmount,currency:e.currency,quantity:e.quantity+1})});case"decrement":return Object(m.a)(Object(m.a)({},e),{},{quantity:e.quantity-1,price:g({amount:e.unitAmount,discountAmount:e.discountAmount,currency:e.currency,quantity:e.quantity-1})});case"setLoading":return Object(m.a)(Object(m.a)({},e),{},{loading:t.payload.loading});case"setError":return Object(m.a)(Object(m.a)({},e),{},{error:t.payload.error});default:throw new Error}}var N=function(e){var t,n=e.selected,c=n.date,i=n.available,s=n.id,o=Object(r.useReducer)(q,{quantity:1,price:null,discountAmount:null,loading:!1,error:null,stripe:null}),u=Object(p.a)(o,2),j=u[0],b=u[1];Object(r.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t,n,a,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/config").then((function(e){return e.json()}));case 2:return t=e.sent,n=t.publicKey,a=t.unitAmount,r=t.discountAmount,c=t.currency,e.t0=b,e.t1=a,e.t2=r,e.t3=c,e.next=13,Object(y.a)(n);case 13:e.t4=e.sent,e.t5={unitAmount:e.t1,discountAmount:e.t2,currency:e.t3,stripe:e.t4},e.t6={type:"useEffectUpdate",payload:e.t5},(0,e.t0)(e.t6);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var m=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b({type:"setLoading",payload:{loading:!0}}),e.next=3,v({quantity:j.quantity,id:s,date:new Date(c).toISOString()});case 3:return n=e.sent,a=n.sessionId,e.next=7,j.stripe.redirectToCheckout({sessionId:a});case 7:r=e.sent,(i=r.error)&&(b({type:"setError",payload:{error:i}}),b({type:"setLoading",payload:{loading:!1}}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsx)(h,{condition:0!==i,fallback:Object(a.jsx)(x,{}),children:Object(a.jsx)("div",{className:"sr-root",children:Object(a.jsx)("div",{className:"sr-main",children:Object(a.jsxs)("section",{className:"container",children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"Cinnamon Roll"}),Object(a.jsxs)("h4",{children:["Pre-order a cinnamon roll for ",c]}),Object(a.jsx)("div",{className:"pasha-image",children:Object(a.jsx)("img",{alt:"Cinnamon Rolls",src:O,width:"100%"})})]}),Object(a.jsxs)("div",{className:"quantity-setter",children:[Object(a.jsx)("button",{className:"increment-btn",disabled:1===j.quantity,onClick:function(){return b({type:"decrement"})},children:"-"}),Object(a.jsx)("input",{type:"number",id:"quantity-input",min:"1",max:i,value:j.quantity,readOnly:!0}),Object(a.jsx)("button",{className:"increment-btn",disabled:j.quantity===Math.min(i,12),onClick:function(){return b({type:"increment"})},children:"+"})]}),Object(a.jsxs)("p",{className:"sr-legal-text",children:["Number of rolls (max ",Math.min(i,12),")"]}),Object(a.jsx)("p",{className:"price",children:"".concat(j.price||"")}),Object(a.jsx)("p",{className:"",children:"I'll need a credit card to confirm your order. It won't be charged until pickup."}),Object(a.jsx)("button",{role:"link",disabled:!j.stripe||j.loading,onClick:m,children:j.loading||!j.price?"Loading...":"Reserve my rolls"}),Object(a.jsx)("div",{className:"sr-field-error",children:null===(t=j.error)||void 0===t?void 0:t.message})]})})})})};n(36);function A(e,t){switch(t.type){case"useEffectUpdate":return t.payload;default:return[]}}function k(){var e=c.a.useState(!1),t=Object(p.a)(e,2),n=t[0],i=t[1],s=c.a.useState({}),o=Object(p.a)(s,2),u=o[0],j=o[1],m=Object(r.useReducer)(A,[]),f=Object(p.a)(m,2),y=f[0],O=f[1];Object(r.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/pre-sales").then((function(e){return e.json()}));case 2:t=e.sent,O({type:"useEffectUpdate",payload:t});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var h=function(e){return 0===e?"Sold Out!":e<=6?"Only ".concat(e," left!"):"".concat(e," available")},x=function(){j({}),i(!1)};return b.a.setAppElement("#root"),Object(a.jsxs)("div",{className:"pre-order-container",children:[Object(a.jsx)("p",{className:"p",children:"Pre-order cinnamon rolls:"}),Object(a.jsx)("ul",{className:"pre-order-list",children:y.map((function(e){var t=e.available,n=e.date,r=e.id;return Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{disabled:0===t,onClick:function(e){return function(e,t){var n=t.date,a=t.id,r=t.available;j({date:n,available:r,id:a}),i(!0)}(0,{date:n,id:r,available:t})},className:"pre-order-date",children:n}),Object(a.jsx)("span",{className:"qty",children:h(t)})]},r)}))}),Object(a.jsxs)(b.a,{isOpen:n,onRequestClose:x,contentLabel:"Pre-Order A Roll",children:[Object(a.jsx)("div",{onClick:x,className:"close-modal-btn",children:"\u2716"}),Object(a.jsx)(N,{selected:u})]})]})}var w=function(){return Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)("header",{className:"App-header",children:Object(a.jsx)("img",{src:o,className:"App-logo",alt:"logo"})}),Object(a.jsx)(k,{})]})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};n(37),n(38);s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(w,{})}),document.getElementById("root")),C()}},[[39,1,2]]]);
//# sourceMappingURL=main.603e7f86.chunk.js.map