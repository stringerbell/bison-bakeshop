{"version":3,"sources":["logo.svg","img/rolls.jpg","RenderIf.js","OutOfStock.js","Checkout.js","Preorder.js","App.js","reportWebVitals.js","index.js"],"names":["RenderIf","props","condition","children","fallback","OutOfStock","date","fetchCheckoutSession","a","quantity","id","fetch","method","headers","body","JSON","stringify","then","res","json","formatPrice","amount","discountAmount","currency","numberFormat","Intl","NumberFormat","style","currencyDisplay","parts","formatToParts","zeroDecimalCurrency","type","total","format","toFixed","reducer","state","action","payload","price","unitAmount","loading","error","Error","Checkout","selected","available","useReducer","stripe","dispatch","useEffect","publicKey","loadStripe","fetchConfig","handleClick","event","Date","toISOString","sessionId","redirectToCheckout","className","alt","src","rolls","width","disabled","onClick","min","max","value","readOnly","Math","role","message","PreOrder","React","useState","modalIsOpen","setIsOpen","setSelected","dates","fetchPreSales","qty","closeModal","Modal","setAppElement","map","e","isOpen","onRequestClose","contentLabel","App","logo","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2d764fb6.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.62cb149e.svg\";","export default __webpack_public_path__ + \"static/media/rolls.35d1b099.jpg\";","export default function RenderIf(props) {\n  if (props.condition) {\n    return props.children\n  }\n  return props.fallback\n};\n","import React from \"react\";\n\nexport default function OutOfStock({date}) {\n  return (\n    <>\n      We're out of stock.\n    </>\n  )\n};\n","import React, {useEffect, useReducer} from 'react';\nimport {loadStripe} from '@stripe/stripe-js';\nimport rolls from './img/rolls.jpg';\nimport RenderIf from \"./RenderIf\";\nimport OutOfStock from \"./OutOfStock\";\n\nconst fetchCheckoutSession = async ({quantity, date, id}) => {\n  return fetch('/create-checkout-session', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      quantity,\n      id,\n      date,\n    }),\n  }).then((res) => res.json());\n};\n\nconst formatPrice = ({amount, discountAmount, currency, quantity}) => {\n  const numberFormat = new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency,\n    currencyDisplay: 'symbol',\n  });\n  const parts = numberFormat.formatToParts(amount);\n  let zeroDecimalCurrency = true;\n  for (let part of parts) {\n    if (part.type === 'decimal') {\n      zeroDecimalCurrency = false;\n    }\n  }\n  amount = zeroDecimalCurrency ? amount : amount / 100;\n  discountAmount = zeroDecimalCurrency ? discountAmount : discountAmount / 100;\n  let total = (amount * quantity);\n  if (quantity > 3) {\n    total = quantity * discountAmount;\n  }\n\n  return numberFormat.format(total.toFixed(2));\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'useEffectUpdate':\n      return {\n        ...state,\n        ...action.payload,\n        price: formatPrice({\n          amount: action.payload.unitAmount,\n          discountAmount: action.payload.discountAmount,\n          currency: action.payload.currency,\n          quantity: state.quantity,\n        }),\n      };\n    case 'increment':\n      return {\n        ...state,\n        quantity: state.quantity + 1,\n        price: formatPrice({\n          amount: state.unitAmount,\n          discountAmount: state.discountAmount,\n          currency: state.currency,\n          quantity: state.quantity + 1,\n        }),\n      };\n    case 'decrement':\n      return {\n        ...state,\n        quantity: state.quantity - 1,\n        price: formatPrice({\n          amount: state.unitAmount,\n          discountAmount: state.discountAmount,\n          currency: state.currency,\n          quantity: state.quantity - 1,\n        }),\n      };\n    case 'setLoading':\n      return {...state, loading: action.payload.loading};\n    case 'setError':\n      return {...state, error: action.payload.error};\n    default:\n      throw new Error();\n  }\n}\n\nconst Checkout = ({selected: {date, available, id}}) => {\n  const [state, dispatch] = useReducer(reducer, {\n    quantity: 1,\n    price: null,\n    discountAmount: null,\n    loading: false,\n    error: null,\n    stripe: null,\n  });\n\n  useEffect(() => {\n    async function fetchConfig() {\n      // Fetch config from our backend.\n      const {publicKey, unitAmount, discountAmount, currency} = await fetch(\n        'https://app.dannstockton.com/b/config'\n      ).then((res) => res.json());\n      // Make sure to call `loadStripe` outside of a component’s render to avoid\n      // recreating the `Stripe` object on every render.\n      dispatch({\n        type: 'useEffectUpdate',\n        payload: {unitAmount, discountAmount, currency, stripe: await loadStripe(publicKey)},\n      });\n    }\n\n    fetchConfig();\n  }, []);\n\n  const handleClick = async (event) => {\n    // Call your backend to create the Checkout session.\n    dispatch({type: 'setLoading', payload: {loading: true}});\n    const {sessionId} = await fetchCheckoutSession({\n      quantity: state.quantity,\n      id,\n      date: (new Date(date)).toISOString(),\n    });\n    // When the customer clicks on the button, redirect them to Checkout.\n    const {error} = await state.stripe.redirectToCheckout({\n      sessionId,\n    });\n    // If `redirectToCheckout` fails due to a browser or network\n    // error, display the localized error message to your customer\n    // using `error.message`.\n    if (error) {\n      dispatch({type: 'setError', payload: {error}});\n      dispatch({type: 'setLoading', payload: {loading: false}});\n    }\n  };\n\n  return (\n    <RenderIf condition={available !== 0} fallback={<OutOfStock/>}>\n      <div className=\"sr-root\">\n        <div className=\"sr-main\">\n          <section className=\"container\">\n            <div>\n              <h1>Cinnamon Roll</h1>\n              <h4>Pre-order a cinnamon roll for {date}</h4>\n              <div className=\"pasha-image\">\n                <img\n                  alt=\"Cinnamon Rolls\"\n                  src={rolls}\n                  width=\"100%\"\n                />\n              </div>\n            </div>\n            <div className=\"quantity-setter\">\n              <button\n                className=\"increment-btn\"\n                disabled={state.quantity === 1}\n                onClick={() => dispatch({type: 'decrement'})}\n              >\n                -\n              </button>\n              <input\n                type=\"number\"\n                id=\"quantity-input\"\n                min=\"1\"\n                max={available}\n                value={state.quantity}\n                readOnly\n              />\n              <button\n                className=\"increment-btn\"\n                disabled={state.quantity === Math.min(available, 12)}\n                onClick={() => dispatch({type: 'increment'})}\n              >\n                +\n              </button>\n            </div>\n            <p className=\"sr-legal-text\">Number of rolls (max {Math.min(available, 12)})</p>\n\n            <p className={'price'}>{`${state.price || ''}`}</p>\n            <p className={''}>I'll need a credit card to confirm your order. It won't be charged until pickup.</p>\n\n            <button\n              role=\"link\"\n              disabled={!state.stripe || state.loading}\n              onClick={handleClick}\n            >{state.loading || !state.price\n              ? `Loading...`\n              : `Reserve my rolls`}\n            </button>\n\n            <div className=\"sr-field-error\">{state.error?.message}</div>\n          </section>\n        </div>\n      </div>\n    </RenderIf>\n  );\n};\n\nexport default Checkout;\n","import React, {useEffect, useReducer} from 'react';\nimport Modal from 'react-modal';\nimport Checkout from \"./Checkout\";\nimport \"./css/preorder.css\";\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'useEffectUpdate':\n      return action.payload;\n    default:\n      return [];\n  }\n}\n\nexport default function PreOrder() {\n  const [modalIsOpen, setIsOpen] = React.useState(false);\n  const [selected, setSelected] = React.useState({})\n  const [dates, dispatch] = useReducer(reducer, []);\n\n  useEffect(() => {\n    async function fetchPreSales() {\n      // Fetch dates/availability from our backend.\n      const dates = await fetch(\n        'https://app.dannstockton.com/b/pre-sales'\n      ).then((res) => res.json());\n      dispatch({\n        type: 'useEffectUpdate',\n        payload: dates,\n      });\n    }\n\n    fetchPreSales();\n  }, []);\n\n  const qty = available => {\n    if (available === 0) {\n      return 'Sold Out!'\n    }\n    if (available <= 6) {\n      return `Only ${available} left!`;\n    }\n    return `${available} available`;\n  }\n\n  const onClick = (event, {date, id, available}) => {\n    setSelected({date, available, id})\n    setIsOpen(true)\n  }\n  const closeModal = () => {\n    setSelected({})\n    setIsOpen(false)\n  }\n  Modal.setAppElement('#root');\n\n  return (\n    <div className={'pre-order-container'}>\n      <p className={'p'}>Pre-order cinnamon rolls:</p>\n      <ul className={'pre-order-list'}>\n        {\n          dates.map(({available, date, id}) => (\n            <div key={id}>\n              <button disabled={available === 0} onClick={(e) => onClick(e, {date, id, available})} className={'pre-order-date'}>{date}</button>\n              <span className={'qty'}>{qty(available)}</span>\n            </div>\n          ))\n        }\n      </ul>\n      <Modal\n        isOpen={modalIsOpen}\n        onRequestClose={closeModal}\n        contentLabel=\"Pre-Order A Roll\"\n      >\n        <div onClick={closeModal} className={'close-modal-btn'}>✖</div>\n        <Checkout selected={selected} />\n      </Modal>\n    </div>\n  );\n}\n","import logo from './logo.svg';\nimport './App.css';\nimport PreOrder from \"./Preorder\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n      </header>\n      <PreOrder />\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport './css/normalize.css';\nimport './css/global.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}