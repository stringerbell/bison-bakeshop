(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{22:function(t,e,n){},23:function(t,e,n){},36:function(t,e,n){},37:function(t,e,n){},38:function(t,e,n){},39:function(t,e,n){"use strict";n.r(e);var a=n(0),c=n(1),r=n.n(c),i=n(9),s=n.n(i),o=(n(22),n.p+"static/media/logo.62cb149e.svg"),u=(n(23),n(3)),l=n.n(u),d=n(4),p=n(5),j=n(10),b=n.n(j),m=n(2),f=n(15),y=n(16),h=n.p+"static/media/rolls.35d1b099.jpg";function O(t){return t.condition?t.children:t.fallback}function x(t){t.date;return Object(a.jsx)(a.Fragment,{children:"We're out of stock."})}var v=function(){var t=Object(d.a)(l.a.mark((function t(e){var n,a,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.quantity,a=e.date,c=e.id,t.abrupt("return",fetch("/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:n,id:c,date:a})}).then((function(t){return t.json()})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g=function(t){var e,n=t.amount,a=t.discountAmount,c=t.currency,r=t.quantity,i=new Intl.NumberFormat("en-US",{style:"currency",currency:c,currencyDisplay:"symbol"}),s=i.formatToParts(n),o=!0,u=Object(f.a)(s);try{for(u.s();!(e=u.n()).done;){"decimal"===e.value.type&&(o=!1)}}catch(d){u.e(d)}finally{u.f()}a=o?a:a/100;var l=(n=o?n:n/100)*r;return r>3&&(l=r*a),i.format(l.toFixed(2))};function q(t,e){switch(e.type){case"useEffectUpdate":return Object(m.a)(Object(m.a)(Object(m.a)({},t),e.payload),{},{price:g({amount:e.payload.unitAmount,discountAmount:e.payload.discountAmount,currency:e.payload.currency,quantity:t.quantity})});case"increment":return Object(m.a)(Object(m.a)({},t),{},{quantity:t.quantity+1,price:g({amount:t.unitAmount,discountAmount:t.discountAmount,currency:t.currency,quantity:t.quantity+1})});case"decrement":return Object(m.a)(Object(m.a)({},t),{},{quantity:t.quantity-1,price:g({amount:t.unitAmount,discountAmount:t.discountAmount,currency:t.currency,quantity:t.quantity-1})});case"setLoading":return Object(m.a)(Object(m.a)({},t),{},{loading:e.payload.loading});case"setError":return Object(m.a)(Object(m.a)({},t),{},{error:e.payload.error});default:throw new Error}}var N=function(t){var e,n=t.selected,r=n.date,i=n.available,s=n.id,o=Object(c.useReducer)(q,{quantity:1,price:null,discountAmount:null,loading:!1,error:null,stripe:null}),u=Object(p.a)(o,2),j=u[0],b=u[1];Object(c.useEffect)((function(){function t(){return(t=Object(d.a)(l.a.mark((function t(){var e,n,a,c,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://app.dannstockton.com/b/config").then((function(t){return t.json()}));case 2:return e=t.sent,n=e.publicKey,a=e.unitAmount,c=e.discountAmount,r=e.currency,t.t0=b,t.t1=a,t.t2=c,t.t3=r,t.next=13,Object(y.a)(n);case 13:t.t4=t.sent,t.t5={unitAmount:t.t1,discountAmount:t.t2,currency:t.t3,stripe:t.t4},t.t6={type:"useEffectUpdate",payload:t.t5},(0,t.t0)(t.t6);case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);var m=function(){var t=Object(d.a)(l.a.mark((function t(e){var n,a,c,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return b({type:"setLoading",payload:{loading:!0}}),t.next=3,v({quantity:j.quantity,id:s,date:new Date(r).toISOString()});case 3:return n=t.sent,a=n.sessionId,t.next=7,j.stripe.redirectToCheckout({sessionId:a});case 7:c=t.sent,(i=c.error)&&(b({type:"setError",payload:{error:i}}),b({type:"setLoading",payload:{loading:!1}}));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsx)(O,{condition:0!==i,fallback:Object(a.jsx)(x,{}),children:Object(a.jsx)("div",{className:"sr-root",children:Object(a.jsx)("div",{className:"sr-main",children:Object(a.jsxs)("section",{className:"container",children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"Cinnamon Roll"}),Object(a.jsxs)("h4",{children:["Pre-order a cinnamon roll for ",r]}),Object(a.jsx)("div",{className:"pasha-image",children:Object(a.jsx)("img",{alt:"Cinnamon Rolls",src:h,width:"100%"})})]}),Object(a.jsxs)("div",{className:"quantity-setter",children:[Object(a.jsx)("button",{className:"increment-btn",disabled:1===j.quantity,onClick:function(){return b({type:"decrement"})},children:"-"}),Object(a.jsx)("input",{type:"number",id:"quantity-input",min:"1",max:i,value:j.quantity,readOnly:!0}),Object(a.jsx)("button",{className:"increment-btn",disabled:j.quantity===Math.min(i,12),onClick:function(){return b({type:"increment"})},children:"+"})]}),Object(a.jsxs)("p",{className:"sr-legal-text",children:["Number of rolls (max ",Math.min(i,12),")"]}),Object(a.jsx)("p",{className:"price",children:"".concat(j.price||"")}),Object(a.jsx)("p",{className:"",children:"I'll need a credit card to confirm your order. It won't be charged until pickup."}),Object(a.jsx)("button",{role:"link",disabled:!j.stripe||j.loading,onClick:m,children:j.loading||!j.price?"Loading...":"Reserve my rolls"}),Object(a.jsx)("div",{className:"sr-field-error",children:null===(e=j.error)||void 0===e?void 0:e.message})]})})})})};n(36);function k(t,e){switch(e.type){case"useEffectUpdate":return e.payload;default:return[]}}function A(){var t=r.a.useState(!1),e=Object(p.a)(t,2),n=e[0],i=e[1],s=r.a.useState({}),o=Object(p.a)(s,2),u=o[0],j=o[1],m=Object(c.useReducer)(k,[]),f=Object(p.a)(m,2),y=f[0],h=f[1];Object(c.useEffect)((function(){function t(){return(t=Object(d.a)(l.a.mark((function t(){var e;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://app.dannstockton.com/b/pre-sales").then((function(t){return t.json()}));case 2:e=t.sent,h({type:"useEffectUpdate",payload:e});case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);var O=function(t){return 0===t?"Sold Out!":t<=6?"Only ".concat(t," left!"):"".concat(t," available")},x=function(){j({}),i(!1)};return b.a.setAppElement("#root"),Object(a.jsxs)("div",{className:"pre-order-container",children:[Object(a.jsx)("p",{className:"p",children:"Pre-order cinnamon rolls:"}),Object(a.jsx)("ul",{className:"pre-order-list",children:y.map((function(t){var e=t.available,n=t.date,c=t.id;return Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{disabled:0===e,onClick:function(t){return function(t,e){var n=e.date,a=e.id,c=e.available;j({date:n,available:c,id:a}),i(!0)}(0,{date:n,id:c,available:e})},className:"pre-order-date",children:n}),Object(a.jsx)("span",{className:"qty",children:O(e)})]},c)}))}),Object(a.jsxs)(b.a,{isOpen:n,onRequestClose:x,contentLabel:"Pre-Order A Roll",children:[Object(a.jsx)("div",{onClick:x,className:"close-modal-btn",children:"\u2716"}),Object(a.jsx)(N,{selected:u})]})]})}var w=function(){return Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)("header",{className:"App-header",children:Object(a.jsx)("img",{src:o,className:"App-logo",alt:"logo"})}),Object(a.jsx)(A,{})]})},C=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,r=e.getLCP,i=e.getTTFB;n(t),a(t),c(t),r(t),i(t)}))};n(37),n(38);s.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(w,{})}),document.getElementById("root")),C()}},[[39,1,2]]]);
//# sourceMappingURL=main.b5a84c97.chunk.js.map